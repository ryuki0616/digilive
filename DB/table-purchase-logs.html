<!DOCTYPE html>
<html lang="ja">
<head>
    <!-- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨­å®š -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="purchase_logsãƒ†ãƒ¼ãƒ–ãƒ«ã®è©³ç´°æƒ…å ± - ãƒ‡ã‚¸ã‚¿ãƒ©ã‚¤ãƒ–ãƒ»ã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼">
    <meta name="keywords" content="purchase_logs, è³¼å…¥ãƒ­ã‚°, ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹, ãƒ†ãƒ¼ãƒ–ãƒ«">
    <meta name="author" content="Digital Live Adventure Team">
    
    <!-- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ« -->
    <title>purchase_logs ãƒ†ãƒ¼ãƒ–ãƒ« | ãƒ‡ã‚¸ã‚¿ãƒ©ã‚¤ãƒ–ãƒ»ã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼</title>
    
    <!-- å¤–éƒ¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ -->
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="table-styles.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <header class="page-header">
            <div class="header-top">
                <a href="database.html" class="back-button">
                    <span class="back-icon">â†</span>
                    <span class="back-text">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸€è¦§</span>
                </a>
                <h1>ğŸ›’ purchase_logs ãƒ†ãƒ¼ãƒ–ãƒ«</h1>
                <div class="header-actions">
                    <a href="../index.html" class="home-button">
                        <span class="home-icon">ğŸ </span>
                        <span class="home-text">ãƒ›ãƒ¼ãƒ </span>
                    </a>
                </div>
            </div>
            <p class="page-subtitle">ã‚·ãƒ§ãƒƒãƒ—ã§ã®è³¼å…¥å±¥æ­´ç®¡ç†</p>
        </header>

        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="table-overview">
            <div class="overview-card">
                <div class="card-header">
                    <div class="table-icon">ğŸ›’</div>
                    <div class="table-info">
                        <h2>purchase_logs</h2>
                        <p>ã‚·ãƒ§ãƒƒãƒ—ã§ã®ã‚¢ã‚¤ãƒ†ãƒ è³¼å…¥å±¥æ­´ã‚’è¨˜éŒ²ã™ã‚‹ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«</p>
                    </div>
                </div>
                <div class="table-stats">
                    <div class="stat-item">
                        <span class="stat-label">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°</span>
                        <span class="stat-value">6</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ä¸»ã‚­ãƒ¼</span>
                        <span class="stat-value">purchase_id</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å¤–éƒ¨ã‚­ãƒ¼</span>
                        <span class="stat-value">2å€‹</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="table-structure">
            <h2>ğŸ“‹ ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ </h2>
            <div class="structure-content">
                <div class="field-list">
                    <div class="field-item primary-key">
                        <div class="field-info">
                            <span class="field-name">purchase_id</span>
                            <span class="field-type">INT</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint pk">PRIMARY KEY</span>
                            <span class="constraint auto">AUTO_INCREMENT</span>
                        </div>
                        <div class="field-description">è³¼å…¥è¨˜éŒ²ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ID</div>
                    </div>

                    <div class="field-item foreign-key">
                        <div class="field-info">
                            <span class="field-name">participant_id</span>
                            <span class="field-type">INT</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint fk">FOREIGN KEY</span>
                            <span class="constraint not-null">NOT NULL</span>
                        </div>
                        <div class="field-description">è³¼å…¥è€…IDï¼ˆparticipantsãƒ†ãƒ¼ãƒ–ãƒ«å‚ç…§ï¼‰</div>
                    </div>

                    <div class="field-item foreign-key">
                        <div class="field-info">
                            <span class="field-name">item_id</span>
                            <span class="field-type">INT</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint fk">FOREIGN KEY</span>
                            <span class="constraint not-null">NOT NULL</span>
                        </div>
                        <div class="field-description">è³¼å…¥ã‚¢ã‚¤ãƒ†ãƒ IDï¼ˆshop_itemsãƒ†ãƒ¼ãƒ–ãƒ«å‚ç…§ï¼‰</div>
                    </div>

                    <div class="field-item quantity">
                        <div class="field-info">
                            <span class="field-name">quantity</span>
                            <span class="field-type">INT</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint default">DEFAULT 1</span>
                        </div>
                        <div class="field-description">è³¼å…¥æ•°é‡ï¼ˆè¤‡æ•°è³¼å…¥å¯¾å¿œï¼‰</div>
                    </div>

                    <div class="field-item required">
                        <div class="field-info">
                            <span class="field-name">total_price</span>
                            <span class="field-type">INT</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint not-null">NOT NULL</span>
                        </div>
                        <div class="field-description">åˆè¨ˆä¾¡æ ¼ï¼ˆå˜ä¾¡ Ã— æ•°é‡ï¼‰</div>
                    </div>

                    <div class="field-item timestamp">
                        <div class="field-info">
                            <span class="field-name">created_at</span>
                            <span class="field-type">DATETIME</span>
                        </div>
                        <div class="field-constraints">
                            <span class="constraint default">DEFAULT CURRENT_TIMESTAMP</span>
                        </div>
                        <div class="field-description">è³¼å…¥æ—¥æ™‚</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- è³¼å…¥ãƒ•ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="purchase-flow">
            <h2>ğŸ”„ è³¼å…¥ãƒ•ãƒ­ãƒ¼</h2>
            <div class="flow-content">
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>ã‚·ãƒ§ãƒƒãƒ—ãƒ–ãƒ¼ã‚¹è¨ªå•</h3>
                        <p>å‚åŠ è€…ãŒã‚·ãƒ§ãƒƒãƒ—ãƒ–ãƒ¼ã‚¹ã«NFCã‚«ãƒ¼ãƒ‰ã‚’ã‹ã–ã™</p>
                    </div>
                </div>
                
                <div class="flow-arrow">â†’</div>
                
                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>ã‚¢ã‚¤ãƒ†ãƒ é¸æŠ</h3>
                        <p>åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã‹ã‚‰è³¼å…¥ã—ãŸã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’é¸æŠ</p>
                    </div>
                </div>
                
                <div class="flow-arrow">â†’</div>
                
                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>æ‰€æŒé‡‘ç¢ºèª</h3>
                        <p>å‚åŠ è€…ã®æ‰€æŒé‡‘ãŒã‚¢ã‚¤ãƒ†ãƒ ä¾¡æ ¼ä»¥ä¸Šã‹ãƒã‚§ãƒƒã‚¯</p>
                    </div>
                </div>
                
                <div class="flow-arrow">â†’</div>
                
                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>è³¼å…¥å‡¦ç†</h3>
                        <p>æ‰€æŒé‡‘ã‚’æ¸›ç®—ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ä¸Šæ˜‡ã•ã›ã‚‹</p>
                    </div>
                </div>
                
                <div class="flow-arrow">â†’</div>
                
                <div class="flow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>ãƒ­ã‚°è¨˜éŒ²</h3>
                        <p>purchase_logsãƒ†ãƒ¼ãƒ–ãƒ«ã«è³¼å…¥å±¥æ­´ã‚’è¨˜éŒ²</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«é–¢ä¿‚ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="table-relationships">
            <h2>ğŸ”— ãƒ†ãƒ¼ãƒ–ãƒ«é–¢ä¿‚</h2>
            <div class="relationships-content">
                <div class="relationship-card">
                    <div class="relationship-header">
                        <span class="relationship-type">å¤šå¯¾1</span>
                        <span class="relationship-direction">â†’</span>
                    </div>
                    <div class="relationship-details">
                        <div class="related-table">
                            <span class="table-icon">ğŸ‘¥</span>
                            <span class="table-name">participants</span>
                        </div>
                        <div class="relationship-description">
                            è¤‡æ•°ã®è³¼å…¥è¨˜éŒ²ã¯1äººã®å‚åŠ è€…ã«å±ã™ã‚‹
                        </div>
                    </div>
                </div>

                <div class="relationship-card">
                    <div class="relationship-header">
                        <span class="relationship-type">å¤šå¯¾1</span>
                        <span class="relationship-direction">â†’</span>
                    </div>
                    <div class="relationship-details">
                        <div class="related-table">
                            <span class="table-icon">ğŸ›ï¸</span>
                            <span class="table-name">shop_items</span>
                        </div>
                        <div class="relationship-description">
                            è¤‡æ•°ã®è³¼å…¥è¨˜éŒ²ã¯1ã¤ã®ã‚¢ã‚¤ãƒ†ãƒ ã«å±ã™ã‚‹
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ä½¿ç”¨ä¾‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="usage-examples">
            <h2>ğŸ’¡ ä½¿ç”¨ä¾‹</h2>
            <div class="examples-content">
                <div class="example-card">
                    <h3>è³¼å…¥è¨˜éŒ²</h3>
                    <div class="sql-example">
                        <pre><code>INSERT INTO purchase_logs 
(participant_id, item_id, quantity, total_price) 
VALUES (1, 3, 2, 200);</code></pre>
                    </div>
                </div>

                <div class="example-card">
                    <h3>å‚åŠ è€…ã®è³¼å…¥å±¥æ­´</h3>
                    <div class="sql-example">
                        <pre><code>SELECT pl.*, p.nickname, si.item_name, si.effect_type
FROM purchase_logs pl
JOIN participants p ON pl.participant_id = p.participant_id
JOIN shop_items si ON pl.item_id = si.item_id
WHERE pl.participant_id = 1
ORDER BY pl.created_at DESC;</code></pre>
                    </div>
                </div>

                <div class="example-card">
                    <h3>äººæ°—ã‚¢ã‚¤ãƒ†ãƒ ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
                    <div class="sql-example">
                        <pre><code>SELECT si.item_name, 
       COUNT(*) as purchase_count,
       SUM(pl.quantity) as total_quantity,
       SUM(pl.total_price) as total_revenue
FROM purchase_logs pl
JOIN shop_items si ON pl.item_id = si.item_id
GROUP BY si.item_id, si.item_name
ORDER BY purchase_count DESC;</code></pre>
                    </div>
                </div>

                <div class="example-card">
                    <h3>å‚åŠ è€…åˆ¥è³¼å…¥çµ±è¨ˆ</h3>
                    <div class="sql-example">
                        <pre><code>SELECT p.nickname,
       COUNT(*) as purchase_count,
       SUM(pl.total_price) as total_spent,
       AVG(pl.total_price) as avg_purchase
FROM purchase_logs pl
JOIN participants p ON pl.participant_id = p.participant_id
GROUP BY p.participant_id, p.nickname
ORDER BY total_spent DESC;</code></pre>
                    </div>
                </div>

                <div class="example-card">
                    <h3>æ™‚é–“åˆ¥è³¼å…¥å‚¾å‘</h3>
                    <div class="sql-example">
                        <pre><code>SELECT DATE(created_at) as purchase_date,
       HOUR(created_at) as purchase_hour,
       COUNT(*) as purchase_count,
       SUM(total_price) as total_revenue
FROM purchase_logs
GROUP BY DATE(created_at), HOUR(created_at)
ORDER BY purchase_date, purchase_hour;</code></pre>
                    </div>
                </div>

                <div class="example-card">
                    <h3>ã‚«ãƒ†ã‚´ãƒªåˆ¥å£²ä¸Šåˆ†æ</h3>
                    <div class="sql-example">
                        <pre><code>SELECT si.effect_type,
       COUNT(*) as purchase_count,
       SUM(pl.quantity) as total_quantity,
       SUM(pl.total_price) as total_revenue,
       AVG(pl.total_price) as avg_price
FROM purchase_logs pl
JOIN shop_items si ON pl.item_id = si.item_id
GROUP BY si.effect_type
ORDER BY total_revenue DESC;</code></pre>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <!-- JavaScriptãƒ•ã‚¡ã‚¤ãƒ« -->
    <script src="table-script.js"></script>
</body>
</html>

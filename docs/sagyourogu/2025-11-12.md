# デジタライブ・アドベンチャー 開発ログ

## 2025-11-12 作業ログ

### 1. 本日の作業概要

[cite_start]「受付システム」開発のため、NFCの技術選定とコア技術の検証、UIプロトタイプの開発を並行して実施しました [cite: 6, 11]。
[cite_start]NFC制御部はPython (pyscard) [cite: 8][cite_start]、UI部はElectron [cite: 8][cite_start]とする方式を決定し、Pythonでの書き込みテスト [cite: 12][cite_start]とElectronでのフォーム画面 [cite: 13][cite_start]、およびデバッグ用の隠しコマンド [cite: 14]を実装しました。

### 2. 主な変更点（ファイル別）

* **`[NFC Tool (Electron App)]`**
    * [cite_start]**新規作成ファイル:** [cite: 25]
        * [cite_start]`index.html`: 参加者登録フォーム（ニックネーム、年齢） [cite: 28]。
        * [cite_start]`next.html`: 登録完了ページ（デバッグ機能） [cite: 30, 34]。
        * [cite_start]`register.js`: `index.html` 用のフォームバリデーション（エラー表示）機能 [cite: 29]。
        * [cite_start]`next.js`: `next.html` 用の隠しコマンド（コナミコマンド等）機能 [cite: 33]。
        * `styles.css`: アプリケーション用スタイルシート。
    * [cite_start]**変更ファイル:** [cite: 26]
        * `main.js`: Electronのメインプロセス設定。
        * [cite_start]`package.json`: プロジェクト設定、`electron` モジュール等の依存関係を定義 [cite: 32]。
* **`[NFC Backend (Python)]`**
    * **新規作成ファイル:**
        * [cite_start]`test_ntag.py`: NTAGカードの書き込みテスト用スクリプト [cite: 17]。

### 3. 技術的なメモ・課題

* **技術選定の決定:**
    * [cite_start]UIはWeb技術（HTML/CSS/JS）との親和性が高い **Electron** を採用 [cite: 8]。
    * [cite_start]NFCリーダー（ACR122U） [cite: 7] [cite_start]の制御部は、**Python (pyscard)** で開発し、ElectronからPythonスクリプトを呼び出す方式に決定しました [cite: 8]。
    * [cite_start]NFCカード規格は『プロジェクト計画書』に基づき、**NTAG相当 (NFC Forum Type 2)** を正式採用としました [cite: 9]。

* **NFCコア技術検証 (Python):**
    * [cite_start]**発生した課題:** Pythonでの書き込みテスト時、エラー `SW=63 00` が発生しました [cite: 17]。
    * [cite_start]**原因特定:** テストに使用したNTAGカード自体のLock bytesが書き込み禁止（読み取り専用）に設定されていることが原因でした [cite: 18, 19]。
    * [cite_start]**結論:** プログラム側のロジックは問題なく、**書き込み保護されていない新品のNTAGカード** が必要であると結論付けました [cite: 19, 45]。
    * [cite_start]**関連ツール:** `pyscard` [cite: 21] [cite_start]および `ACR122U PC/SCドライバ` [cite: 22] をインストール済みです。

* **隠しコマンド機能の実装 (next.js):**
    * [cite_start]登録完了ページ (`next.html`) に、デバッグおよび運営効率化のため、特定のキーシーケンスで動作する隠しコマンドを実装しました [cite: 34]。
    * [cite_start]**コナミコマンド** (`↑↑↓↓←→←→BA`): 8つのボックスの数値を一括変更できるモーダルを表示します [cite: 36]。
    * [cite_start]**文字列・ショートカット:** `secret`, `reset` コマンドおよび `Ctrl+Shift+S`, `Ctrl+Shift+R` などのショートカットを実装しました [cite: 37, 38]。
    * [cite_start]3秒以上キー入力がない場合、入力履歴 (`keySequence`) をリセットするタイムアウト処理も実装しました [cite: 42]。

### 4. 関連ドキュメント・タスク

* **関連ドキュメント:**
    * [cite_start]`プロジェクト計画書.md` (NFCカード規格の選定根拠 [cite: 9])
* **現在の状況:**
    * [cite_start]**バックエンド:** 読み書きロジックは完成。新品カード待ち [cite: 45]。
    * [cite_start]**フロントエンド:** 登録フォームUIとデバッグ機能は実装完了 [cite: 46]。
* **最優先のタスク:**
    * [cite_start]**ElectronとPythonの連携:** `main.js` から `child_process` を使い、Pythonスクリプトを呼び出してNFCカードのIDmなどを `index.html` に表示する [cite: 48]。
    * [cite_start]**NFC書き込み機能:** 「登録」ボタンをトリガーに、Python経由でカードへデータを書き込む機能を実装する [cite: 49]。